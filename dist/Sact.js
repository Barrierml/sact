(()=>{"use strict";function t(t,e){let n;if(n=t.attrsMap[e]){t.attrsMap[e]=null;for(let n=0,o=t.attrs.length;n<o;n++)if(t.attrs[n].name===e){t.attrs.splice(n,1);break}}return n}function e(t){return t&&"object"==typeof t&&null!==t}function n(t,n){if(!e(n))return t;for(let e of Reflect.ownKeys(n))t[e]=n[e];return t}const o=new RegExp("{{\\s*([\\w\\.\\(\\)\\]\\[\\|&]+)\\s*}}");function r(t){let e=o.exec(t);return e?[e[1],e.index,e.index+e[0].length]:[]}const s=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,i=/^\s*((?:s-[\w-]+:|@|#)\[[^=]+?\][^\s"'<>\/=]*)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,l="[a-zA-Z_][\\-\\.0-9_a-zA-Z]*",a=`((?:${l}\\:)?${l})`,c=new RegExp(`^<${a}`),f=/^\s*(\/?)>/,u=new RegExp(`^<\\/${a}[^>]*>`),p=/^<!DOCTYPE [^>]+>/i,h=/^<!\--/,d=/^<!\[/;function m(t){let e={};for(let n of t)e[n.name]=n.value;return e}let g=0;const $=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['.*?'\]|\[".*?"\]|\[\d+\]|\[[A-Za-z_$][\w$]*\])*$/;function y(e){let n;return(n=t(e,"s-for"))?function(t,e){const n=e.match(/([^]*?)\s+(?:in|of)\s+([^]*)/);if(!n)throw new Error("无效 s-for 表达式: "+e);return`_f_(${n[2]},function(${n[1].trim().replace("(","").replace(")","")}){\n      return ${y(t)}\n    })`}(e,n):(n=t(e,"s-if"))?function(t,e){return`(${e}) ? ${y(t)} : null`}(e,n):"template"===e.tagName?k(e):`_c_('${e.tagName}', ${function(e){if(!e.attrs.length)return"{}";let n="{",o="attrs:{",r={},s=!1,i=!1,l=!1,a="props:{";const c=t(e,"s:class")||t(e,"s-bind:class")||t(e,":class");c&&(n+=`class: ${c},`);const f=t(e,"class");f&&(n+=`staticClass: "${f}",`);for(let t=0,c=e.attrs.length;t<c;t++){let c=e.attrs[t],f=c.name,u=c.value;if(/^s-bind:|^:|s:/.test(f))f=f.replace(/^:|^s-bind:|^s:/,""),"style"===f?n+=`style: ${u},`:"key"===f?n+=`key: (${u}),`:/^(value|selected|checked|muted)$/.test(f)?(i=!0,a+=`"${f}": (${u}),`):(s=!0,o+=`"${f}": (${u}),`);else if(/^@|^s-on:|^s@/.test(f)){const t=v(f);f=w(f),l=!0,f=f.replace(/^@|^s-on:|^s@/,""),b(r,f,u,t)}else if(/^s-modal/.test(f)){const t=v(f);f=w(f),l=!0,f=f.replace(/^s-modal/,""),i=!0,a+=`"${_(r,e.tagName,u,t)}": (${u}),`}else s=!0,o+=`"${f}": (${JSON.stringify(u)}),`}return s&&(n+=o.slice(0,-1)+"},"),i&&(n+=a.slice(0,-1)+"},"),l&&(n+=function(t){let e="on:{";for(let n in t)e+=`"${n}":${x(t[n])},`;return e.slice(0,-1)+"}"}(r)),n.replace(/,$/,"")+"}"}(e)}, ${k(e)},${g++})`}function v(t){const e=t.match(/\.[^\.]+/g);if(e)return e.map((t=>t.slice(1)))}function w(t){return t.replace(/\.[^\.]+/g,"")}function _(t,e,n,o){let r="let _v_ =",s="change",i="value";switch(e){case"input":s="input",r+="$event.target.value;",i="value";break;case"select":s="change",r+="$event.target.value;",i="value"}if(Array.isArray(o))for(let t=0;t<o.length;t++)"trim"===o[t]?r+="_v_ = _v_.trim && _v_.trim();":"number"===o[t]&&(r+="_v_ = parseInt(_v_) || _v_;");return r+=`${n} = _v_;`,t[s]={value:r},i}function b(t,e,n,o){const r=o&&o.indexOf("capture");r>-1&&(o.splice(r,1),e="!"+e);const s={value:n,modifiers:o},i=t[e];Array.isArray(i)?i.push(s):t[e]=i?[i,s]:s}const A={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();"};function x(t){if(t){if(Array.isArray(t))return`[${t.map(x).join(",")}]`;if(t.modifiers&&t.modifiers.length){let e="function($event){";for(let n=0;n<t.modifiers.length;n++){let o=t.modifiers[n];e+=A[o]}return e+($.test(t.value)?t.value+"()":t.value)+"}"}return $.test(t.value)?t.value:`function($event){${t.value}}`}return"function(){}"}function k(t){return t.children.length?"["+t.children.map((t=>t.tagName?y(t):function(t){if(" "===t)return'" "';{const e=function(t){if(!o.test(t))return null;let[e,n,s]=r(t),i=[];for(;e;)0!==n&&i.push(`'${t.substring(0,n).trim()}'`),i.push(`(${e})`),t=t.substring(s),[e,n,s]=r(t);return t&&i.push(`'${t.trim()}'`),i.join("+")}(t);return e?"("+e+")":JSON.stringify(t)}}(t))).join(",")+"]":"undefined"}function C(t,n,o){return new Proxy(n,{set(t,e,n,o){let r=Reflect.set(t,e,n,o);return function(t,e){let n=E.get(t);if(n){let t=n.get(e);if(t)for(let e of t)H(e)}}(t,e),r},get(n,o,r){const s=Reflect.get(n,o,r);return function(t,e,n){let o=E.get(t);o||E.set(t,o=new Map);let r=o.get(e);r||o.set(e,r=new Set),n&&!r.has(n)&&r.add(n)}(n,o,t),e(s)||Array.isArray(s)?C(t,s):s}})}const E=new WeakMap,O=[];let R=!1,S={},N=!1;function K(){R=!0}function M(){var t;R=!0,t=j,L.push((()=>{t&&t.call(undefined)})),z||(z=!0,P())}function H(t){let e=t.cid;N||S[e]||(S[e]=!0,O.push(t)),R||M()}function j(){let t;N=!0;for(let e=0;e<O.length;e++)t=O[e],t.notify&&t.notify();O.length=0,R=!1,N=!1,S={}}const L=[];let P,z=!1;function I(){z=!1;const t=L.slice(0);L.length=0;for(let e=0;e<t.length;e++)t[e]()}if("undefined"!=typeof Promise){const t=Promise.resolve();P=()=>{t.then(I)}}else if(isIE||"undefined"==typeof MutationObserver||!isNative(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())P="undefined"!=typeof setImmediate&&isNative(setImmediate)?()=>{setImmediate(I)}:()=>{setTimeout(I,0)};else{let t=1;const e=new MutationObserver(I),n=document.createTextNode(String(t));e.observe(n,{characterData:!0}),P=()=>{t=(t+1)%2,n.data=String(t)}}class T{constructor(t,e,n,o,r,s,i){this.context=t,this.tag=s?"_text_":e,this.data=n,this.componentOptions=r,this.parent=void 0,this.text=s?e:void 0,this.key=n&&n.key,this.element=void 0,this.zid=i,this.children=Z(o,t,this)}getParentEle(){let t=this.parent;for(;t&&!t.element;)t=t.parent;return t&&t.element}}function Z(t,e,n){let o=[];if(t){for(let r of t)Array.isArray(r)?o=o.concat(Z(r,e,n)):"string"==typeof r?o.push(new T(e,r,void 0,void 0,void 0,!0)):r&&o.push(r);return o.map((t=>(t.parent=n,t)))}}function D(t,n){t.$options=n,function(t){const e=t.$options;t.callHooks=function(n){let o=e[n],r=typeof o;return"shouldUpdate"===n?function(e,n){return!o||"function"!==r||o.apply(t,[e,n])}:o&&"function"===r?o.apply(t):void 0}}(t),t.callHooks("beforeCreate"),function(t){const e=t.$options;let{props:n}=e;"function"==typeof n?t.props=n():n&&(t.props=n)}(t),function(t){const e=t.$options;if(e.ele){if(t.$ele=document.querySelector(e.ele),!t.$ele&&!t.isComponent)throw new Error(`无效ele ${e.ele}`);t.$template=t.$ele.outerHTML}e.template&&(t.$template=e.template)}(t),function(t){const n=t.$options;if(e(n.method)){let{method:e}=n;for(let o of Reflect.ownKeys(e)){if("function"===(e[o],!1))throw new Error(`${o} 不为function，请检查！`);t[o]=n.method[o].bind(t)}}t._c_=(e,n,o,r)=>function(t,e,n,o,r){const{componentList:s,components:i}=t;return s&&s.includes(e)?function(t,e,n,o,r,s){return new T(n,"sact-component-"+s+"-"+r,e,void 0,{Ctor:t,tag:r,children:Z(o)},!1,s)}(i[e],n,t,o,e,r):"slot"===e?function(t,e,n){if(t.$slot){let n=e.attrs&&e.attrs.name;return n?t.$slot[n]||null:t.$slot.default}return n}(t,n,o):new T(t,e,n,o,void 0,!1,r)}(t,e,n,o,r),t._f_=(t,e)=>function(t,e){let n=[],o=typeof t;if(Array.isArray(t))n=t.map(e);else if("object"===o){let o=0;for(let r of Reflect.ownKeys(t))n.push(e(r,o))}else if("string"===o)for(let o of t)n.push(e(o));else if("number"==typeof t)for(let o=1;o<=t;o++)n.push(e(o));else if("number"===o)for(let o=0;o<t;o++)n.push(e(o));return n}(t,e)}(t),function(t){const e=t.$options;let n=e.data;e.data&&"function"==typeof e.data&&(n=n.apply(t)),!1===e.reactive?t.data=n:t.data=C(t,n||{})}(t),function(t){const n=t.$options;let{isComponent:o,component:r,isAbstract:s}=n;if(o&&(t.isComponent=!0,t.isAbstract=s,t.name=n.name,t.isShowAttr=n.isShowAttr||!0),t.componentList=[],e(r))for(let e of Reflect.ownKeys(r))t.componentList.push(e);t.components=r||{},t.cid=Number.parseInt(100*Math.random())}(t),function(t){const e=t.$options;if(!0===t.isAbstract)t._render=()=>null;else{if(!t.$template)throw t._render=null,Error("请填写有效的模板字段！");t.$createVnode=function(t){const e=y(t);return new Function(`with(this){\n        with(data){\n             return ${e}\n        }\n    }`)}(function(t){const e=[];let n,o,r,l=0,a=t;for(;t;){n=t;let o,s,i,a=t.indexOf("<");if(0===a){if(h.test(t)){const e=t.indexOf("--\x3e");if(e>=0){g(e+3);continue}}const e=t.match(p);if(e){console.log("处理html声明"),g(e[0].length);continue}const n=t.match(u);if(n){const t=l;g(n[0].length),y(n[1],t);continue}const o=$();o&&v(o)}if(a>=0){for(s=t.slice(a);!(u.test(s)||c.test(s)||h.test(s)||d.test(s)||(i=s.indexOf("<",1),i<0));)a+=i,s=t.slice(a);o=t.substring(0,a)}a<0&&(o=t),o&&(g(o.length),o.replace(/\s+/g,"")&&(r?e[e.length-1].children.push(o):r=o))}return r;function g(e){l+=e,t=t.substring(e)}function $(){const e=t.match(c);if(e){const n={tagName:e[1],attrs:[],start:l};let o,r;for(g(e[0].length);!(o=t.match(f))&&(r=t.match(i)||t.match(s));)r.start=l,g(r[0].length),r.end=l,n.attrs.push(r);if(o)return n.unarySlash=o[1],g(o[0].length),n.end=l,n}}function y(t,n,r){let s,i;if(t){for(i=t.toLowerCase(),s=e.length-1;s>=0&&e[s].tagName!==i;s--);if(s>=0)for(let t=e.length-1;t>s;t--)e[s].children.push(e[t]),e[t].parent=e[s];if(s<0)throw new Error(`\nSact-AstError:存在一个没有开始节点闭合节点！\n${a.substring(0,n)}---\x3e ${a.substring(n)} <-----\n`);s&&(e[s].parent=e[s-1],e[s-1].children.push(e[s])),o=s?e[s-1]:e[s],e.length=s}else console.log("标签：《"+t+"》,没有找到闭合的标签！")}function v(t){let n=t.tagName,s=t.unarySlash,[i,l]=function(e){const n=e.length,o=new Array(n);for(let e=0;e<n;e++){const n=t.attrs[e],r=n[3]||n[4]||n[5]||"";o[e]={name:n[1],value:r}}return[o,m(o)]}(t.attrs),a={tagName:n,attrs:i,attrsMap:l,children:[]};r||(r=a),s||"input"===n||"img"===n?(a.parent=o,r&&r!==a&&e[e.length-1].children.push(a)):e.push(a)}}(t.$template)),t._render=()=>t.$createVnode.apply(t)}let{render:n}=e;n&&"function"==typeof n&&(t._render=e=>n.apply(t,[t._c_,e]))}(t),t.callHooks("created"),function(t){let e=t.getplug();if(e)for(let n of e)K(),n.install&&n.install.call(n,t),M()}(t)}const U={insert(t,e,n){n?e.insertBefore(t,n):e.appendChild(t)},remove(t){const e=t.parentNode;e&&e.removeChild(t)},replace(t,e){const n=t.parentNode;n&&n.replaceChild(e,t)},next:t=>t&&t.nextElementSibling,pre:t=>t&&t.previousElementSibling,setElementText(t,e){t.textContent=e},setAttribute(t,e,n){e&&t.setAttribute(e,n)},removeAttribute(t,e){t.removeAttribute(e)}};function V(t,e){if(e){let n;n=G(t),U.replace(e,n)}else{let e=t.warpSact.wrapVnode,n=e.getParentEle(),o=t.element||G(t),r=e.parent.children.indexOf(e)-1,s=e.parent.children[r].element;U.insert(o,n,U.next(s))}}function J(t,e){var n,o,r,s;"_text_"===t.tag?t.text!==e.text&&(s=e.text,t.element.textContent=s):t.componentOptions&&e.componentOptions?function(t,e){let n=e.componentOptions,o=t.componentOptions,r=n.Ctor=o.Ctor,s=[r.$slot,r.props];r.$slot=Q(n.children),r.props=X(r,e.data);let i=[r.$slot,r.props];r.callHooks("beforeUpdate"),r.callHooks("shouldUpdate")(s[1],i[1])&&function([t,e],[n,o]){if(t!==n)return!0;if(e&&o){let t=Reflect.ownKeys(e),n=Reflect.ownKeys(o);if(t.length!==n.length)return!0;for(let r=0;r<t.length;r++){let s=t[r],i=n[r];if(e[s]!==o[i])return!0}}return!1}(s,i)&&(r.patch(),nt(r.$ele,r.props))}(t,e):(function(t,e){let n,o=t.data,r=e.data;Y(o,r,"class")?Y(o,r,"staticClass")||U.setAttribute(t.element,"class",r.staticClass):(n=r.staticClass||"",U.setAttribute(t.element,"class",(n+" "+r.class).trim())),Y(o,r,"style")||ot(t.element,r.style),B(o.attrs,r.attrs,"attrs",t.element),B(o.props,r.props,"props",t.element),B(o.on,r.on,"on",t.element)}(t,e),n=t.children,o=e.children,r=t.element,n&&n.length>0&&o&&0===o.length||n&&!o?n.forEach((t=>{tt(t)})):n&&0===n.length&&o&&o.length>0||!n&&o?et(r,o):n&&1===n.length&&o&&1===o.length&&q(n[0],o[0])?J(n[0],o[0]):n&&o&&function(t,e,n){let o,r,s,i=0,l=0,a=e.length-1,c=n.length-1,f=e[0],u=n[0],p=e[a],h=n[c];for(;i<=a&&l<=c;)if(q(f,u))J(f,u),f=e[++i],u=n[++l];else{if(!q(p,h))break;J(p,h),p=e[--a],h=n[--c]}--i<a&&(o=e.slice(i+1,a+1)),--l<c&&(r=n.slice(l+1,c+1)),o||(o=[]),r||(r=[]),s=-1===i?e[a+1]&&e[a+1].element:U.next(e[i].element);for(let e of r){let n=!1;for(let r of o)if(!r.patched&&q(e,r)){U.insert(r.element,t,s),J(r,e),r.patched=!0,s=U.next(e.element),n=!0;break}if(!n){let n=G(e);U.insert(n,t,s),s=U.next(e.element)}}for(let t of o)t.patched||tt(t)}(r,n,o)),e.element=t.element}function q(t,e){return t.tag===e.tag&&t.key===e.key}function B(t,e,n,o){let r=[];if(e&&t){for(let s of Reflect.ownKeys(e))Y(e,t,s)||("attrs"===n?U.setAttribute(o,s,e[s]):"on"===n?F(o,s,e[s],t[s]):o[s]=e[s],r.push(s));for(let s of Reflect.ownKeys(t))Y(e,t,s)||r.includes(s)||("attrs"===n?U.removeAttribute(o,s):"on"===n?W(o,newAttr,t[newAttr]):o[newAttr]=null)}}function F(t,e,n,o){W(t,e,o),st(t,{[e]:n})}function W(t,e,n){t.removeEventListener(e,n._wrapper)}function Y(t,e,n){return t[n]===e[n]}function G(t){if("_text_"===t.tag)return t.element=document.createTextNode(t.text),t.element;if(t.componentOptions)return function(t,e){let{Ctor:n,children:o}=e,{key:r,data:s}=t;n=e.Ctor=n(),n.wrapVnode=t;let i=X(n,s);n.$slot=Q(o);let l=null;n.callHooks("beforeMount");let a=n.$vnode=n._render(i);return a&&(l=n.$ele=n.$vnode.element=t.element=G(a),n.isShowAttr&&nt(l,i),r&&U.setAttribute(l,"key",r)),n.callHooks("mounted"),l}(t,t.componentOptions);let{tag:e,data:n,children:o,key:r}=t,s=t.element=document.createElement(e);return n&&nt(s,n,t.context),o&&et(s,o),r&&U.setAttribute(s,"key",r),t.element=s,s}function Q(t){let e={};if(Array.isArray(t))return e.default=t,e}function X(t,o){let r=n({},t.props),{attrs:s,on:i,props:l}=o;for(let t of[s,i,l])if(e(t))for(let e of Reflect.ownKeys(t))r[e]=t[e];return t.props=r,r}function tt(t){t.componentOptions&&t.componentOptions.Ctor.destory(),U.remove(t.element)}function et(t,e){if(Array.isArray(e))for(let n of e){let e=G(n);Array.isArray(e)?e.map((e=>{t.appendChild(e)})):e&&t.appendChild(e)}}function nt(t,e,n){let o="";for(let n of Reflect.ownKeys(e)){switch(n){case"attrs":it(t,e[n]);break;case"on":st(t,e[n]);break;case"props":rt(t,e[n]);break;default:"staticClass"===n||"class"===n?o+=e[n]+" ":"style"===n?ot(t,e[n]):U.setAttribute(t,n,e[n])}""!==o&&U.setAttribute(t,"class",o.trim())}}function ot(t,e){let n=typeof e;if(Array.isArray(e))for(let n=0;n<e.length;n++){if("object"!=typeof e[n])throw new Error(`${n} 并不是一个对象！`);ot(t,e[n])}else if("object"===n){let n=Reflect.ownKeys(e);for(let o=0;o<n.length;o++){let r=n[o];t.style[r]=e[r]}}else"string"===n&&(t.style=e)}function rt(t,e){for(let n of Reflect.ownKeys(e))t[n]=e[n]}function st(t,e){let n=Reflect.ownKeys(e);for(let o=0;o<n.length;o++){let r=n[o],s=e[r]._wrapper=function(){if("function"!=typeof e[r])throw new Error(`${r} 不是一个合法的函数，请检查！`);K(),e[r](...arguments),M()};t.addEventListener(r,s)}}function it(t,e){for(let n of Reflect.ownKeys(e))U.setAttribute(t,n,e[n])}const lt=[];class at{constructor(t){this.$ele=void 0,D(this,t),!this.isComponent&&this.render()}getplug(){return lt}render(){if(this.callHooks("beforeMount"),!this.render)throw new Error("渲染函数无效,请检查您输入的参数，是否存在有效的ele或者template",this.$options);this.$vnode=this._render(),V(this.$vnode,this.$ele),this.callHooks("mounted")}patch(){this.isComponent||this.callHooks("beforeUpdate");let t=this.$vnode;var e,n;this.$vnode=this._render(this.props),this.$vnode&&(this.$vnode.warpSact=this),(e=t)!==(n=this.$vnode)&&(e&&!n?tt(e):q(e,n)?J(e,n):V(n,e.element)),this.callHooks("updated")}notify(){this.patch()}destory(){this.callHooks("beforeDestory"),function(t){for(let e of Reflect.ownKeys(E))for(let n of Reflect.ownKeys(e))e[n].has(t)&&e[n].delete(t)}(this)}}at.__proto__.component=function(t){return function(){return new at({...t,isComponent:!0})}},at.__proto__.use=function(t){lt.push(t)},at.__proto__.link=function(){const t={};return new Proxy({},{get:function(e,o,r){return"do"===o?new at(t):function(e){return t[o]?n(t[o],e):t[o]=e,this}}})};const ct=at.component({name:"keep-alive",data:()=>({old:!0,cache:[]}),isAbstract:!0,reactive:!1,mounted(){let t=this.$slot.default[0];t&&(this.data.cache[0]=t)},render(){let t=this.$slot.default[0];return t&&1===this.data.cache.length&&!this.data.old?(this.data.old=!0,this.data.cache[0]):t?(this.data.cache[0]=t,this.data.old=!0,t):void(this.data.old=!1)}}),ft={install(t){t.componentList.push("keep-alive"),t.components["keep-alive"]=ct}};at.use(ft),window.Sact=at})();